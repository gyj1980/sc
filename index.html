<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ç›´æ’­æºæ–‡ä»¶ä¸Šä¼ å·¥å…·</title>
<style>
/* å®Œå…¨å¤åˆ»åŸæ ·å¼ */
*{box-sizing:border-box}
body{margin:0;font:14px/1.5 "Microsoft YaHei";background:#f9fafb;color:#374151;display:flex;flex-direction:column;min-height:100vh}
.top-nav,.footer-links{background:#4285f4;text-align:center;padding:10px 0;font-size:0}
.top-nav a,.footer-links a{color:#fff;font-size:13px;margin:0 8px;padding:4px 6px;text-decoration:none}
.top-nav a:hover,.footer-links a:hover{text-decoration:underline}
.container{width:100%;max-width:800px;margin:0 auto 24px;padding:16px;background:#fff;border-radius:0 0 8px 8px;box-shadow:0 0 6px rgba(0,0,0,.04);flex:1}
h2{font-size:18px;text-align:center;margin:0 0 16px}
label{font-size:14px;margin-bottom:6px;display:block}
input[type=text],textarea{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:15px;resize:none}
textarea{min-height:140px}
button{border:none;border-radius:6px;padding:12px 0;font-size:15px;font-weight:600;color:#fff;cursor:pointer;transition:filter .2s;margin-right:8px}
button:hover{filter:brightness(1.1)}
.enc{background:#f093fb}.copy{background:#f7b801}.clear{background:#ef476f}.down{background:#4895ef}
.desc{color:#64748b;text-align:center;margin-bottom:20px;font-size:14px}
.section{margin-bottom:20px;padding:20px;background:#f8fafc;border-radius:8px;border:1px solid #e2e8f0}
.file-info{font-size:12px;color:#64748b;margin-top:8px}
.action-buttons{display:flex;flex-wrap:wrap;gap:10px;margin-top:20px}
.link-box{display:flex;gap:10px;margin-top:10px}
.link-box input{flex:1;padding:10px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px}
.msg{padding:12px;border-radius:6px;margin-top:15px;font-weight:500;display:none}
.msg.success{background:rgba(6,214,160,.2);color:#057a5c;border-left:4px solid #06d6a0}
.msg.error{background:rgba(239,71,111,.2);color:#b71540;border-left:4px solid #ef476f}
</style>
</head>
<body>

<div class="top-nav">
    <a href="index.html">æˆ‘çš„ä¸»é¡µ</a>
    <a href="1.html">æ ¼å¼è½¬æ¢</a>
    <a href="2.html">åŠ å¯†å·¥å…·</a>
    <a href="pl.html">æ‰¹é‡å·¥å…·</a>
</div>

<div class="container">
    <h2>ç›´æ’­æºæ–‡ä»¶ä¸Šä¼ ä¸ç¼–è¾‘å·¥å…·</h2>
    <p class="desc">æ”¯æŒä¸Šä¼ TXT/M3Uæ–‡ä»¶åç¼–è¾‘å†…å®¹ï¼Œæˆ–ç›´æ¥è¾“å…¥å†…å®¹ç”Ÿæˆæ–‡ä»¶ã€‚æ¯æ¬¡æäº¤å°†è¦†ç›–åŒä¸€æ–‡ä»¶ã€‚</p>

    <!-- æ–‡ä»¶ä¸Šä¼  -->
    <div class="section">
        <label>ğŸ“ é€‰æ‹©æ–‡ä»¶</label>
        <input type="file" id="fileUpload" accept=".txt,.m3u">
        <p class="file-info">æ”¯æŒ.txtå’Œ.m3uæ ¼å¼æ–‡ä»¶ï¼Œæœ€å¤§ä¸è¶…è¿‡5MB</p>
        <div class="btn-grid">
            <button class="enc" onclick="loadFile()">åŠ è½½æ–‡ä»¶</button>
        </div>
    </div>

    <!-- ç¼–è¾‘åŒº -->
    <div class="section">
        <label>âœï¸ ç¼–è¾‘æ–‡ä»¶</label>
        <textarea id="content" placeholder="è¯·è¾“å…¥æˆ–ç²˜è´´ç›´æ’­æºå†…å®¹..."></textarea>
        <div class="action-buttons">
            <button class="down" onclick="saveFile()">ä¿å­˜å¹¶è¦†ç›–</button>
            <button class="clear" onclick="clearContent()">æ¸…ç©ºå†…å®¹</button>
        </div>
    </div>

    <!-- é“¾æ¥å±•ç¤º -->
    <div class="section" id="linkArea" style="display:none">
        <label>ğŸ”— æ–‡ä»¶é“¾æ¥</label>
        <div class="link-box">
            <input type="text" id="fileLink" readonly>
            <button class="copy" onclick="copyLink()">å¤åˆ¶é“¾æ¥</button>
        </div>
    </div>

    <!-- æç¤º -->
    <div id="msg" class="msg"></div>
</div>

<div class="footer-links">
    <a onclick="window.open('https://link3.cc/gyjune')">æˆ‘çš„å·¥å…·ç®±</a>
    <a onclick="alert('é‚®ç®±ï¼šgyjune@126.com')">æˆ‘çš„é‚®ç®±</a>
    <a onclick="window.open('https://weibo.com/u/1771411553')">æˆ‘çš„å¾®åš</a>
    <a href="1.html">æ ¼å¼è½¬æ¢</a>
    <a href="zby.html">ç›´æ’­æºç”Ÿæˆå·¥å…·</a>
    <a href="/">ç›´æ’­æºä¸Šä¼ å·¥å…·</a>
</div>
<div class="copyright">Copyright Â© 2025 å¤šåŠŸèƒ½ç½‘ç«™ | ç‰ˆæƒæ‰€æœ‰</div>

<script>
let fixedUrl = ""; // é€šè¿‡ /save è¿”å›

function loadFile(){
    const f=document.getElementById('fileUpload').files[0];
    if(!f){showMsg('è¯·å…ˆé€‰æ‹©æ–‡ä»¶','error');return}
    if(f.size>5*1024*1024){showMsg('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MB','error');return}
    const r=new FileReader();
    r.onload=e=>{
        document.getElementById('content').value=e.target.result;
        showMsg('æ–‡ä»¶å†…å®¹å·²åŠ è½½','success');
    };
    r.readAsText(f);
}

async function saveFile(){
    const c=document.getElementById('content').value.trim();
    if(!c){showMsg('å†…å®¹ä¸èƒ½ä¸ºç©º','error');return}
    showMsg('æ­£åœ¨ä¿å­˜...','success');
    const res=await fetch('/save',{method:'POST',body:c});
    const data=await res.json();
    fixedUrl=data.url;
    document.getElementById('fileLink').value=fixedUrl;
    document.getElementById('linkArea').style.display='block';
    showMsg('âœ… æ–‡ä»¶å·²ä¿å­˜ï¼ˆè¦†ç›–gyj.txtï¼‰','success');
}

function clearContent(){
    document.getElementById('content').value='';
    showMsg('ç¼–è¾‘æ¡†å·²æ¸…ç©º','success');
}

function copyLink(){
    const i=document.getElementById('fileLink');
    i.select();
    document.execCommand('copy');
    showMsg('âœ… é“¾æ¥å·²å¤åˆ¶','success');
}

function showMsg(text,type){
    const m=document.getElementById('msg');
    m.textContent=text;
    m.className='msg '+type;
    setTimeout(()=>m.className='msg',3000);
}

// é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¯»å–å·²æœ‰å†…å®¹
fetch('/read').then(r=>r.text()).then(t=>document.getElementById('content').value=t);
</script>
</body>
</html>
